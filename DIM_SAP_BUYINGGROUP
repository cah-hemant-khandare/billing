  --SMNTC_DIM.DIM_SAP_BUYINGGROUP--SAP-16774 bq-16917
SELECT
  TPCBGP.PCBGP PCBGP_TPCBGP,
  TPCBGP.AUTPLC AUTPLC_TPCBGP,
  TPCBGPT.DESCR DSECR_TPCBGPT,
  TPCBORGT.NAME NAME_TPCBORGT,
  TPCBGP.BORGN BORGN_TPCBGP,
  TPCBGP.COTID COTID_TPCBGP,
  TPCIDT.NAME NAME_TPCIDT,
  TPCBGP.COTTY COTTY_TPCBGP,
  TPCBGP.LOESCH LOESCH_TPCBGP,
  TPCBGP.GPO_CD GPO_CO_TPCBGP,
  TPCBGP.SPCBG SPCBG_TPCBGP,
  TPCBGP.PLCREF PLCREF_TPCBGP,
  TPCID.STDCOT STDCOT_TPCID,
  TPCCOTT.NAME NAME_TPCCOTT,
  TPCBGP.VFDAT VFDAT_TPCBGP,
  TPCBGP.VTDAT VTDAT_TPCBGP,
  TPCBORG.ORGTYP ORGTYP_TPCBORG
FROM
  `datamarket-np-cah.SI_ORP_SAP.IRM_TPCBGPT` AS TPCBGPT
INNER JOIN
  `datamarket-np-cah.SI_ORP_SAP.IRM_TPCBGP` AS TPCBGP
ON
  TPCBGPT.SPCBG= TPCBGP.SPCBG
  AND TPCBGPT.PCBGP = TPCBGP.PCBGP
LEFT OUTER JOIN
  `datamarket-np-cah.SI_ORP_SAP.IRM_TPCBORG` AS TPCBORG
ON
  TPCBGP.BORGN = TPCBORG.BORGN
LEFT OUTER JOIN
  `datamarket-np-cah.SI_ORP_SAP.IRM_TPCBORGT` AS TPCBORGT
ON
  TPCBGP.BORGN =TPCBORGT.BORGN
  AND TPCBORGT.SPRAS = 'E'
LEFT OUTER JOIN
  `datamarket-np-cah.SI_ORP_SAP.IRM_TPCID` AS TPCID
ON
  TPCBGP.COTID = TPCID.COTID
LEFT OUTER JOIN
  `datamarket-np-cah.SI_ORP_SAP.IRM_TPCCOTT` AS TPCCOTT
ON
  TPCCOTT.SPRAS = 'E'
  AND TPCID.STDCOT = TPCCOTT.STDCOT
LEFT OUTER JOIN
  `datamarket-np-cah.SI_ORP_SAP.IRM_TPCIDT` AS TPCIDT
ON
  TPCCOTT.NAME= TPCIDT.COTID
  AND TPCIDT.SPRAS = 'E'
WHERE
  TPCBGPT.SPRAS = 'E'